{"componentChunkName":"component---src-templates-post-template-tsx","path":"/Spring/스프링비즈니스로직/순환참조/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EB%B0%9C%EB%8B%A8\">발단</a></p>\n<ul>\n<li>\n<p><a href=\"#%EB%AC%B8%EC%A0%9C\">문제</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%83%9D%EC%84%B1%EC%9E%90-%EC%A3%BC%EC%9E%85-vs-%ED%95%84%EB%93%9C-%EC%A3%BC%EC%9E%85\">생성자 주입 vs 필드 주입</a></p>\n<ul>\n<li><a href=\"#%EC%83%9D%EC%84%B1%EC%9E%90-%EC%A3%BC%EC%9E%85\">생성자 주입</a></li>\n<li><a href=\"#%ED%95%84%EB%93%9C-%EC%A3%BC%EC%9E%85\">필드 주입</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","html":"<h2>발단</h2>\n<p>서비스간 의존성 주입을 함</p>\n<p>예)</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\r\n<span class=\"token annotation punctuation\">@RequiredArgsConstructor</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TaskService</span> <span class=\"token punctuation\">{</span>\r\n\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">PlanService</span> planService<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">/// ... 기타 메서드</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>SchedulerService 에서 PlanService 를 의존함</p>\n<p>여기서 발생할 수 있는 문제는??</p>\n<h3>문제</h3>\n<p><strong>순환 의존성 문제가 발생 할 수 있음</strong></p>\n<p>순환 의존성이란 ?</p>\n<blockquote>\n<p>A 서비스가 B 서비스를 주입하고 B 서비스가 A 서비스를 다시 주입하는 경우 순환 의존성이 발생한다.\r\n이는 런타임 에러를 일으킬 수 있으므로 주의가 필요하다.</p>\n</blockquote>\n<p>위의 코드에서는 TaskService => PlanService 를 주입하기 때문에\r\n문제가 발생하지 않았지만\r\n만약에 PlanService => TaskService 주입한다면??</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\r\n<span class=\"token annotation punctuation\">@RequiredArgsConstructor</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PlanService</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">TaskService</span> taskService<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// 기타 메서드</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>애플리케이션을 실행 했을 때 컴파일 에러가 발생한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8cf388a2492a2b52ad09d43f0abf44cd/5e281/img.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 4.6875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAANUlEQVR42jWKQQoAMAjD9iMHWuv/P+ZU5iEU0hwAaWbZS3J2XeOOwsdFMFWr/V+7/ra9IvkABvcgRbLzBikAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8cf388a2492a2b52ad09d43f0abf44cd/a59e9/img.webp 192w,\n/static/8cf388a2492a2b52ad09d43f0abf44cd/0ca9f/img.webp 384w,\n/static/8cf388a2492a2b52ad09d43f0abf44cd/dc9b9/img.webp 768w,\n/static/8cf388a2492a2b52ad09d43f0abf44cd/e2c2f/img.webp 1152w,\n/static/8cf388a2492a2b52ad09d43f0abf44cd/e6692/img.webp 1407w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8cf388a2492a2b52ad09d43f0abf44cd/3b721/img.png 192w,\n/static/8cf388a2492a2b52ad09d43f0abf44cd/66595/img.png 384w,\n/static/8cf388a2492a2b52ad09d43f0abf44cd/fe486/img.png 768w,\n/static/8cf388a2492a2b52ad09d43f0abf44cd/d2d74/img.png 1152w,\n/static/8cf388a2492a2b52ad09d43f0abf44cd/5e281/img.png 1407w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8cf388a2492a2b52ad09d43f0abf44cd/fe486/img.png\"\n            alt=\"img.png\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ceeeafdfd3c3f052076ce225498a2f5a/b59ab/img_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlElEQVR42q2PTQ4CIQyFuQ4FJlAK49KY6Kj3v099HYUYM0sXH/17LXkuhKD/xHnv9Rf6wmoTHs0C0dQMXGtNezf6jqCuiAaLqEjVlJIyswp6BT2GJte6U5Gv6+m9i5mzx45OUF8hfOLAGTDymKL2UvSBfEO8o3/LWTdwQc+O2a597o7sRrB84rBs9hLywUIGTc2w/AKZJpn97rPsRQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ceeeafdfd3c3f052076ce225498a2f5a/a59e9/img_1.webp 192w,\n/static/ceeeafdfd3c3f052076ce225498a2f5a/0ca9f/img_1.webp 384w,\n/static/ceeeafdfd3c3f052076ce225498a2f5a/dc9b9/img_1.webp 768w,\n/static/ceeeafdfd3c3f052076ce225498a2f5a/426c3/img_1.webp 922w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ceeeafdfd3c3f052076ce225498a2f5a/3b721/img_1.png 192w,\n/static/ceeeafdfd3c3f052076ce225498a2f5a/66595/img_1.png 384w,\n/static/ceeeafdfd3c3f052076ce225498a2f5a/fe486/img_1.png 768w,\n/static/ceeeafdfd3c3f052076ce225498a2f5a/b59ab/img_1.png 922w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ceeeafdfd3c3f052076ce225498a2f5a/fe486/img_1.png\"\n            alt=\"img_1.png\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>응 ?? 런타임 에러가 아니고 컴파일 에러??</p>\n<p>여기서 의존성 주입을 하는 방식에 따라 <strong>런타임 에러</strong>가 날수도 있고 <strong>컴파일 에러</strong>가 발생할 수 있다.</p>\n<p>위의 코드 방식은 생성자 주입을 통해 의존성을 주입 하였다.</p>\n<p>그래서 순환 참조가 발생 했을 때 컴파일 에러가 발생하였다.</p>\n<p>만약 @Autowired 를 통한 필드 주입 방식을 한다면?</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TaskService</span> <span class=\"token punctuation\">{</span>\r\n\r\n    <span class=\"token annotation punctuation\">@Autowired</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">PlanService</span> planService<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">/// ... 기타 메서드</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\r\n\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TaskService</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token annotation punctuation\">@Autowired</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">PlanService</span> planService<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// 기타 메서드..</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>컴파일 에러가 발생하지 않고, 런타임 에러가 발생한다.</p>\n<h3>생성자 주입 vs 필드 주입</h3>\n<br/>\n<h4>생성자 주입</h4>\n<ul>\n<li>의존성을 클래스의 생성자를 통해 주입하는 방식</li>\n<li>순환 참조 문제가 발생할 가능성이 낮아진다.</li>\n<li>객체 생성 시점에 의존성을 주입하기 때문이다.</li>\n<li>만약 순환 참조가 발생하면 컴파일 오류나 런타임 오류로 쉽게 감지 할 수 있다.</li>\n<li>대부분의 의존성 주입 프레임워크와 컨테이너에서 생성자 주입을 권장하고 지원한다.</li>\n</ul>\n<h4>필드 주입</h4>\n<ul>\n<li>의존성을 클래스의 멤버 변수로 직접 주입하는 방식이다.</li>\n<li>순환 참조 문제를 발생시킬 가능성이 높아질 수 있다.</li>\n<li>필드 주입을 통해 객체 생성 후에 의존성이 주입되므로 순환 참조가 발생하더라도 런타임에 오류가 감지된다.</li>\n<li>일반적으로 생성자 주입보다 순환 참조 문제를 발생시키기 쉽기 때문에 권장되지 않는다.</li>\n</ul>","frontmatter":{"title":"Dependency Injection 시 순환 참조","summary":"Dependecy Injection 시 순환 참조가 발생할 수 있는 코드","date":"2023.09.20.","categories":["Spring"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlElEQVR42q2PzQ4CIQyEeR3+NlBKd4/GRFd9//ep040QD+vNw5eZloEwLsao/8R57/WM8IXNFj47iyHMjOFERHvvKmLIAWNuUIOYlblpzlmJSBm7ih0hU1o7aPDruh13nT3GCJhOMN8QfOGBCyD4lJNKrfqE36EP7O+l6A6u2I2PuV91E1g+OipbvQw/WIIRZsYqvwGeK5oHgZMyoAAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/ceeeafdfd3c3f052076ce225498a2f5a/3d2ab/img_1.png","srcSet":"/static/ceeeafdfd3c3f052076ce225498a2f5a/61769/img_1.png 231w,\n/static/ceeeafdfd3c3f052076ce225498a2f5a/869c3/img_1.png 461w,\n/static/ceeeafdfd3c3f052076ce225498a2f5a/3d2ab/img_1.png 922w","sizes":"(min-width: 922px) 922px, 100vw"},"sources":[{"srcSet":"/static/ceeeafdfd3c3f052076ce225498a2f5a/86803/img_1.webp 231w,\n/static/ceeeafdfd3c3f052076ce225498a2f5a/71d54/img_1.webp 461w,\n/static/ceeeafdfd3c3f052076ce225498a2f5a/316bb/img_1.webp 922w","type":"image/webp","sizes":"(min-width: 922px) 922px, 100vw"}]},"width":922,"height":223}},"publicURL":"/static/ceeeafdfd3c3f052076ce225498a2f5a/img_1.png"}}}}]}},"pageContext":{"slug":"/Spring/스프링비즈니스로직/순환참조/"}},"staticQueryHashes":[],"slicesMap":{}}