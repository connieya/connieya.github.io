{"componentChunkName":"component---src-templates-post-template-tsx","path":"/Spring/스프링캐싱사용하기/스프링캐싱/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%BA%90%EC%8B%9C-%EB%8F%84%EC%9E%85-%ED%95%98%EA%B8%B0\">캐시 도입 하기</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-%EC%BA%90%EC%8B%9C-%EC%82%AC%EC%9A%A9\">스프링 캐시 사용</a></p>\n<ul>\n<li>\n<p><a href=\"#local-cache-vs-global-cache\">Local Cache vs Global Cache</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%A0%81%EC%9A%A9\">적용</a></p>\n<ul>\n<li><a href=\"#maven-%EC%84%A4%EC%A0%95\">maven 설정</a></li>\n<li><a href=\"#enablecacheing-%EC%84%A4%EC%A0%95\">@EnableCacheing 설정</a></li>\n<li><a href=\"#%EC%BA%90%EC%8B%9C%ED%95%A0-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%97%90-cacheable-%EC%82%AC%EC%9A%A9\">캐시할 데이터에 @Cacheable 사용</a></li>\n<li><a href=\"#cachemanager%EB%A1%9C-%EC%BA%90%EC%8B%9C-%EC%82%AD%EC%A0%9C\">CacheManager로 캐시 삭제</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","html":"<p>건강, 식습관 관리 서비스를 개발하면서 스프링 캐시를 적용해보았다.</p>\n<p>건강 , 식습관 관리 서비스에서 사용자가 계획한 시간과 빈도에 맞게 활동을 잘 수행하면\r\n그에 맞는 포인트를 제공한다.</p>\n<p>그리고 활동이 끝나면 획득한 총 포인트를 상품권을 교환해준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/aacdadff12dcaffe2096b4626152ad91/47fb9/point.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.708333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACP0lEQVR42jWSTU8TYRSF+x/9Ay4McWvEEHGpcYEBdeUCQkiIQTCKgppIaQAphX53WuxMp1/TTqftzPR7WtpOWx7fNvFNTt57z+LmnJzjGTgWvbaBpsYp5lICSSqlNIO+Rd8xGRhF6nubdIJ/aMRvMANn1P2n2CE/tpjbqShdJUlPlujXNDyDcY+uQM0qiUMZjLKKVS8wvGst0BZ74WAb49qHKQWxbsOYAvVkED1yiSXHsNNRmmJ3zPlBKYS5+56JnOAecMcjJq7LcHiH647RMhFS0gWJiA9dvqLqO6B6sod6uIV/c43c1y2qgWPK2RsatQwe76s36I8f4Kw/YzJxuZVipG8llL9z+yqDTpW8UGHoWaqpS2KvnyK9fELu7QvUjVVyaytkdtbxe/epFBJ4jkI6ge0dRhc/mC4UDhkLuK5QOhnTbWjYFZmOmaOuxYlHvGQzNzRNhYYp07QUtGyI6OURpqHgyZQbBJUaA3fGVByYzibMZjOBKff3M6EuROz6F5Grn+iZILYcWKAQPOH6+CNa+BRLFXwpQcfO49n4kmT53TeKqsL86aXiwrYUDQmbJfpNnaISFWEpGNI50vMlkssPkVeXSK08Qhaz+uElwfNDjLnlM6+X7/u7+MIZxu6U8WhIq2nTajUZDPp0bY1KXqJRzWIIayHfZ9Kh35j5MDURxPzPJ8+5OvlEVUuJlHt1HNFDx2nS69miKm1Goy6jYYc7UZueCKXfreJ0DNHXCt2WLjhjwf/HnOs0yzi9Ov8AGit6bwkPZjwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/aacdadff12dcaffe2096b4626152ad91/a59e9/point.webp 192w,\n/static/aacdadff12dcaffe2096b4626152ad91/0ca9f/point.webp 384w,\n/static/aacdadff12dcaffe2096b4626152ad91/dc9b9/point.webp 768w,\n/static/aacdadff12dcaffe2096b4626152ad91/e2c2f/point.webp 1152w,\n/static/aacdadff12dcaffe2096b4626152ad91/cba34/point.webp 1246w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/aacdadff12dcaffe2096b4626152ad91/3b721/point.png 192w,\n/static/aacdadff12dcaffe2096b4626152ad91/66595/point.png 384w,\n/static/aacdadff12dcaffe2096b4626152ad91/fe486/point.png 768w,\n/static/aacdadff12dcaffe2096b4626152ad91/d2d74/point.png 1152w,\n/static/aacdadff12dcaffe2096b4626152ad91/47fb9/point.png 1246w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/aacdadff12dcaffe2096b4626152ad91/fe486/point.png\"\n            alt=\"img.png\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>사용자는 메인 화면에서 이번 회차에서 설정한 목표와 획득 점수 그리고 총 점수를 볼 수 있다.</p>\n<h2 id=\"캐시-도입-하기\" style=\"position:relative;\"><a href=\"#%EC%BA%90%EC%8B%9C-%EB%8F%84%EC%9E%85-%ED%95%98%EA%B8%B0\" aria-label=\"캐시 도입 하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>캐시 도입 하기</h2>\n<p>획득한 총 점수는 식이 관리 점수 + 활동 (미술 or 운동) 점수를 합한 점수로\r\n활동 로그가 저장된 테이블에서 쿼리한 결과를 응답 받아서 렌더링 한다.</p>\n<p>그리고 개발 하던 중에 다음과 같은 생각이 들었다.</p>\n<p>“활동 로그가 저장된 테이블은 오전 12시에 한 번 스케줄링으로 업데이트 되기 때문에\r\n총 점수는 다음 날까지 변경이 되지 않잖아?? ”</p>\n<p>하루가 지나기 전에는 계속 같은 결과일 텐데\r\nDB로 계속 쿼리를 날리는 것은 비효율적이라고 판단하여 캐시를 도입하였다.</p>\n<h2 id=\"스프링-캐시-사용\" style=\"position:relative;\"><a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-%EC%BA%90%EC%8B%9C-%EC%82%AC%EC%9A%A9\" aria-label=\"스프링 캐시 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>스프링 캐시 사용</h2>\n<p>스프링 캐시를 사용하기 전, 선택해야 할 것이 있었다.</p>\n<p>로컬 캐싱과 글로벌 캐싱 두 가지 전략 중 하나를 선택해야 한다.</p>\n<h3 id=\"local-cache-vs-global-cache\" style=\"position:relative;\"><a href=\"#local-cache-vs-global-cache\" aria-label=\"local cache vs global cache permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Local Cache vs Global Cache</h3>\n<p><strong>로컬 캐싱</strong>은 서버 내부 저장소에 캐시 데이터를 저장한다. 따라서\r\n속도는 빠르지만 서버 간의 데이터 공유가 안된다는 단점이 있다.\r\n예를 들어, 사용자가 같은 리소스에 대한 요청을 반복해서 보내더라도,\r\nA 서버에서는 이전 데이터를, B 서버에서는 최신 데이터를 반환하여\r\n각 캐시가 서로 다른 상태를 가질수도 있다.\r\n즉, 일관성 문제가 발생할 수 있다는 것이다.</p>\n<p><strong>글로벌 캐싱</strong>은 서버 내부 저장소가 아닌 별도의 캐시 서버를 두어\r\n서버에서 캐시 서버를 참조하는 것이다. 캐시 데이터를 얻으려 할때 마다\r\n네트워크 트래픽이 발생하기 때문에 로컬 캐싱보다 속도는 느리지만,\r\n서버간 데이터를 쉽게 공유할 수 있기 때문에 로컬 캐싱의 정합성 문제와\r\n중복된 캐시 데이터로 인한 서버 자원 낭비 등 문제점을 해결할 수 있다.</p>\n<p>지금 개발하고 있는 서비스는 단일 서버에서 서비스를 운영하며,\r\n다수의 서버 인스턴스 간 데이터 공유가 필요하지 않으며\r\n클라이언트의 트래픽도 관리할 필요가 없는 상황이었다.</p>\n<p>그래서 고민할 것도 없이 로컬 캐싱 전략을 선택하였다.</p>\n<h3 id=\"적용\" style=\"position:relative;\"><a href=\"#%EC%A0%81%EC%9A%A9\" aria-label=\"적용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>적용</h3>\n<h4 id=\"maven-설정\" style=\"position:relative;\"><a href=\"#maven-%EC%84%A4%EC%A0%95\" aria-label=\"maven 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>maven 설정</h4>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.boot<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-boot-starter-cache<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h4 id=\"enablecacheing-설정\" style=\"position:relative;\"><a href=\"#enablecacheing-%EC%84%A4%EC%A0%95\" aria-label=\"enablecacheing 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@EnableCacheing 설정</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@SpringBootApplication</span>\r\n<span class=\"token annotation punctuation\">@EnableCaching</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Application</span> <span class=\"token punctuation\">{</span>\r\n\r\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token class-name\">SpringApplication</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Application</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>@EnableCaching 은 이 프로젝트에서 캐시 관련 애노테이션(@Cacheable, @CacheEvict)을\r\n사용하겠다는 선언이다.</p>\n<h4 id=\"캐시할-데이터에-cacheable-사용\" style=\"position:relative;\"><a href=\"#%EC%BA%90%EC%8B%9C%ED%95%A0-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%97%90-cacheable-%EC%82%AC%EC%9A%A9\" aria-label=\"캐시할 데이터에 cacheable 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>캐시할 데이터에 @Cacheable 사용</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Cacheable</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"pointInfoCache\"</span><span class=\"token punctuation\">,</span>  key <span class=\"token operator\">=</span> <span class=\"token string\">\"#planDto.userId\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">selectTotalPoint</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PlanDto</span> planDto<span class=\"token punctuation\">)</span>\r\n        log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"총점 가져오기 \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> planDAO<span class=\"token punctuation\">.</span><span class=\"token function\">selectTotalPoint</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 value는 캐시 데이터의 이름이고, Key는 캐시 데이터의 키 값이 된다.</p>\n<p>사용자별로 총점을 가져오는 쿼리이기 때문에</p>\n<p>userId 에 따라 캐시 여부를 체크하여 캐시가 안되어 있을 경우, 캐시를 하고,\r\n있으면 캐시 된 것을 응답하게 된다.</p>\n<p>실제로 실행 해본 결과,</p>\n<p>최초로 실행 되었을 때만</p>\n<p>“log.info(“총점 가져오기 ”);”</p>\n<p>에 해당하는 문장이 출력되었고, 이 후 요청에는 메서드가 실행 되지 않고\r\n캐싱 된 데이터가 응답되었다.</p>\n<p><strong>@Cacheable 동작 원리</strong></p>\n<p>@Cacheable 은 AOP 기반으로 동작한다.</p>\n<ul>\n<li>@Cacheable 애노테이션을 가진 메서드에 대한 캐싱 동작을 정의한다.</li>\n<li>스프링은 @Cacheable 애노테이션을 가진 메서드를 호출할 때 프록시 객체를 생성한다.\r\n이 프록시 객체는 AOP를 사용하여 메서드 호출을 가로채고 캐싱 동작을 처리한다.</li>\n<li>AOP 프록시는 실제 메서드 호출 전에 캐시에 캐시된 결과가 있는지 확인하고, 결과가 존재하는 경우 메서드 실행을\r\n스킵하고 캐시 된 결과를 반환한다.</li>\n</ul>\n<h4 id=\"cachemanager로-캐시-삭제\" style=\"position:relative;\"><a href=\"#cachemanager%EB%A1%9C-%EC%BA%90%EC%8B%9C-%EC%82%AD%EC%A0%9C\" aria-label=\"cachemanager로 캐시 삭제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CacheManager로 캐시 삭제</h4>\n<p>CahceManager로 캐시를 삭제해보자.</p>\n<p>사용자 별 총점 값이 수정되거나 삭제가 일어났을 때 캐시를\r\n삭제하지 않으면 총점을 캐시 메모리에서 조회 할 때\r\n변경 하기 전 총점을 반환하게 되면서 일관성이 깨지게 된다.</p>\n<p>스케줄러를 통해 매일 사용자의 활동 로그를 저장하는 데,\r\n이때 캐시를 삭제 하면 일관성이 깨지지 않게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"> <span class=\"token annotation punctuation\">@Scheduled</span><span class=\"token punctuation\">(</span>cron <span class=\"token operator\">=</span> <span class=\"token string\">\"0 1 0 * * *\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">synchronized</span> <span class=\"token keyword\">void</span> <span class=\"token function\">saveActivityDailyHis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n            scheduler<span class=\"token punctuation\">.</span><span class=\"token function\">saveActivityDailyHis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token class-name\">Cache</span> cache <span class=\"token operator\">=</span> cacheManager<span class=\"token punctuation\">.</span><span class=\"token function\">getCache</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pointInfoCache\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cache <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                cache<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"스프링 캐싱을 사용하여 응답 속도를 개선하고 불필요한 IO 작업 줄이기","summary":"서비스 개발 중 자주 조회하지만 변경이 잘 일어 나지 않는 데이터에 캐싱을 적용해보았습니다.","date":"2023.10.02.","categories":["Spring"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACP0lEQVR42jWSW08TURSF+x/9Az4Y4qsRQ8RHjQ8YUJ98gBASYhCMoqAmUhpAyqXTG9Nip5229DKdodN7ZzptZ3r5PG3iSVbO3uvk7KyVtX0928Sxa1htnaIap5BLCiSolFI4vRrzd71AdWedTugPjfg15uUJ1eAxdSlIXdTtZJRuOoGlyPhmwxzXoitwXyuJQRn0skqteseg35qjLfq7vU30qwCmHKJ2G8YUqCZCaJFzakqMeipKU/Q+bzrCkSXM7feMlBumgOcOGXkeg0Efz3MpZiIk5TNuIgE05QIjsIdxtIO6v0FwfYXc1w2My0PK2Wt8RtvC/+oN2uMH2KvPGI08buUYqVuZ9N+ZfRWnY5AXKnQti5E8J/b6KfLLJ+TevkBdWya3skRma5WgfxefZVscSBqXm1sMz34wnisc4Ap4nlA6cuk2itQrCh0zR7UYJx7xk81c0zTTNEyFZi1NMSsRPT/A1x/YZMoNQul7HG/CWAwYT0ZMJhOBMdPpRKiTiF39InLxEy0Toq5cznEXOuLq8CPF8DE1VfClGxFK32HtS4LFd98oqGlmRysV5rblqCRslug1NQrpqAgrjS6fIj9fILH4EGV5geTSIxRRqx9eEjrdxzcau5z4/Xzf3SYQzuB6Y9zhgFazTqvVxHF6dOtFKnmZhpFFF9akwGdS0m/MfJh7EcTszidOuTj6JCw74pNVxRZ7aNtNLKsuVqXNcNhlOOjQF2tjiVB6XQO7o4t9rdBtaYLT5/x/zLhOs8w/9y58HkKrV60AAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/aacdadff12dcaffe2096b4626152ad91/25e2e/point.png","srcSet":"/static/aacdadff12dcaffe2096b4626152ad91/6b133/point.png 312w,\n/static/aacdadff12dcaffe2096b4626152ad91/7c7a1/point.png 623w,\n/static/aacdadff12dcaffe2096b4626152ad91/25e2e/point.png 1246w","sizes":"(min-width: 1246px) 1246px, 100vw"},"sources":[{"srcSet":"/static/aacdadff12dcaffe2096b4626152ad91/73578/point.webp 312w,\n/static/aacdadff12dcaffe2096b4626152ad91/63383/point.webp 623w,\n/static/aacdadff12dcaffe2096b4626152ad91/bee4b/point.webp 1246w","type":"image/webp","sizes":"(min-width: 1246px) 1246px, 100vw"}]},"width":1246,"height":532}},"publicURL":"/static/aacdadff12dcaffe2096b4626152ad91/point.png"}}}}]}},"pageContext":{"slug":"/Spring/스프링캐싱사용하기/스프링캐싱/"}},"staticQueryHashes":[],"slicesMap":{}}