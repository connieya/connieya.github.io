<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.12.8"/><meta data-react-helmet="true" name="description" content="개인 프로젝트를 하면서  Spring Security와 JWT를 활용하여 사용자 인증을 구현했습니다."/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1.0"/><meta data-react-helmet="true" http-equiv="Content-Type" content="text/html;charset=UTF-8"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="Spring Security 와 JWT 를 사용하여 로그인 구현하기"/><meta data-react-helmet="true" property="og:description" content="개인 프로젝트를 하면서  Spring Security와 JWT를 활용하여 사용자 인증을 구현했습니다."/><meta data-react-helmet="true" property="og:image" content="/static/0dbc63fefc503efe6407f5e7164655fb/img_2.png"/><meta data-react-helmet="true" property="og:url"/><meta data-react-helmet="true" property="og:site_name" content="Spring Security 와 JWT 를 사용하여 로그인 구현하기"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Spring Security 와 JWT 를 사용하여 로그인 구현하기"/><meta data-react-helmet="true" name="twitter:description" content="개인 프로젝트를 하면서  Spring Security와 JWT를 활용하여 사용자 인증을 구현했습니다."/><meta data-react-helmet="true" name="twitter:image" content="/static/0dbc63fefc503efe6407f5e7164655fb/img_2.png"/><meta data-react-helmet="true" name="twitter:site" content="@사용자이름"/><meta data-react-helmet="true" name="twitter:creator" content="@사용자이름"/><meta data-react-helmet="true" name="google-site-verification" content="웹 마스터 도구가 제공하는 Meta 태그"/><meta data-react-helmet="true" name="naver-site-verification" content="웹 마스터 도구가 제공하는 Meta 태그"/><style data-href="/styles.9e907bc32054b7771552.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">Spring Security 와 JWT 를 사용하여 로그인 구현하기</title><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://connieya.github.io/Project/JWT를통한인증/jwt/" data-baseprotocol="https:" data-basehost="connieya.github.io"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css 13ku56z">.css-13ku56z{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100%;}</style><div class="css-13ku56z esjg9ma0"><style data-emotion="css 1l1mfmq">.css-1l1mfmq{position:fixed;top:0;z-index:10;width:100%;height:60px;background:linear-gradient(
    90deg,
    #423434,
    #988b3f 25%,
    #967950 46%,
    #af7a28 69%,
    #eceb08
  );}</style><div class="css-1l1mfmq e1o8p83g1"><style data-emotion="css 1p3pcfy">.css-1p3pcfy{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:28px;padding-top:6px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#fff;font-family:Catamaran;font-weight:800;margin-left:20px;opacity:0.7;}</style><a class="css-1p3pcfy e1o8p83g0" href="/">Connieya</a></div><style data-emotion="css-global kxm5mf">@import url('https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700;800&display=swap');*{padding:0;margin:0;box-sizing:border-box;font-family:'Nanum Myeongjo',serif;}html,body,#___gatsby{height:100%;}a,a:hover{color:inherit;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;}</style><style data-emotion="css 11k3q87">.css-11k3q87{position:relative;width:100%;max-width:768px;margin:0 auto;}</style><div class="css-11k3q87 e17f455w0"><style data-emotion="css 1fttcpj">.css-1fttcpj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="css-1fttcpj ehbuenk5"><style data-emotion="css 9aqgc6">.css-9aqgc6{width:100%;max-width:768px;margin:4rem auto;}</style><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained css-9aqgc6 ehbuenk4"><div style="max-width:931px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;606&#x27;%20width=&#x27;931&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+UlEQVR42mVTy5LUMBCb74mf7Vec1+wss0UVBbtcOXCB//8HITvJsAsHVXccR5bkzqVerxjHjHUilhlP9zt+fH/F79cX/Hr7jJ/fvhBf8cb69HzHdr1h477rdsV2u2PZbpiWDTMxzQsuKY/QxsBoBS8BMSZMOWGrM9Z5xcKNCzeWqRIjag0oRTCyL1NBSAInDhJ9r5dUKoy1JDQI4kmYkXLBTLJSRySqPyHRwTgN602vDU4MrDVQSkFR1EHo4J3FNtcufVk3jDy5hIgQEmJqh4wIVB+4ZrTeCRoG9bdXB6F1DloNKGMjXJFigLcKAzdo9e5j9ppkwzB0qAO9/5ewLTqjaSuhOo8XESxeeq7e+64yxAjpqmNX+7535FAU9SBs7N4o5OAxcm3mpdRakUvhIYG5OWZl4UhuuL/l3tRqZr9DnwqnB2G76cyQ15JRy0LrGZEKGppKTQdNseFUaPUxu/8s77eku8rkCFoUaRYDq0CcYa6yK9HDoU49sAsyHzNsNoR9IMk4Lf2SImcy5sB543oiOSNx3sIH2pcdvlVOSTv8IPTdrmO13vecWl6WFtt6V0TlJ7oaqx/Pre/PxD6HfWxokye1PyWGwnqA85fL2FVbzmtz02F3mF53AT3DeFpmJpn1ztA/+QbpeD5zPNHGSGQH37vHaEkX9Qc5NZrJ3KmTPAAAAABJRU5ErkJggg==" alt=""/><picture><source type="image/webp" data-srcset="/static/0dbc63fefc503efe6407f5e7164655fb/1ff34/img_2.webp 233w,/static/0dbc63fefc503efe6407f5e7164655fb/6c6ac/img_2.webp 466w,/static/0dbc63fefc503efe6407f5e7164655fb/707eb/img_2.webp 931w" sizes="(min-width: 931px) 931px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 931px) 931px, 100vw" decoding="async" loading="lazy" data-src="/static/0dbc63fefc503efe6407f5e7164655fb/d035f/img_2.png" data-srcset="/static/0dbc63fefc503efe6407f5e7164655fb/70c2d/img_2.png 233w,/static/0dbc63fefc503efe6407f5e7164655fb/87f0f/img_2.png 466w,/static/0dbc63fefc503efe6407f5e7164655fb/d035f/img_2.png 931w" alt="해당 포스트 썸네일 이미지"/></picture><noscript><picture><source type="image/webp" srcSet="/static/0dbc63fefc503efe6407f5e7164655fb/1ff34/img_2.webp 233w,/static/0dbc63fefc503efe6407f5e7164655fb/6c6ac/img_2.webp 466w,/static/0dbc63fefc503efe6407f5e7164655fb/707eb/img_2.webp 931w" sizes="(min-width: 931px) 931px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 931px) 931px, 100vw" decoding="async" loading="lazy" src="/static/0dbc63fefc503efe6407f5e7164655fb/d035f/img_2.png" srcSet="/static/0dbc63fefc503efe6407f5e7164655fb/70c2d/img_2.png 233w,/static/0dbc63fefc503efe6407f5e7164655fb/87f0f/img_2.png 466w,/static/0dbc63fefc503efe6407f5e7164655fb/d035f/img_2.png 931w" alt="해당 포스트 썸네일 이미지"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><div><style data-emotion="css 255c6r">.css-255c6r{word-break:keep-all;}</style><h1 class="css-255c6r ehbuenk2">Spring Security 와 JWT 를 사용하여 로그인 구현하기</h1></div><style data-emotion="css jr6aws">.css-jr6aws{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;color:#757575;}</style><div class="css-jr6aws ehbuenk3"><style data-emotion="css s5xdrg">.css-s5xdrg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-s5xdrg ehbuenk1"><style data-emotion="css onhpl3">.css-onhpl3{margin:0.25rem;padding:0.25rem;}.css-onhpl3:first-of-type{margin:0.25rem 0.25rem 0.25rem 0;}</style><span role="checkbox" aria-checked="false" class="css-onhpl3 e12y0cgh1"><style data-emotion="css 1gprwe9">.css-1gprwe9{z-index:9;display:inline-block;padding:0.25rem 0.75rem;color:#000000 font-size:0.9rem;font-weight:600;white-space:nowrap;background-color:-m-a-i-n:#f5f5f8;-s-u-b:#e4f1ff;-s-u-b_-m-i-d-d-l-e_-b-o-l-d:#badcff;-s-u-b_-b-o-l-d:#0E68C8;-w-h-i-t-e:#ffffff;-b-l-a-c-k:#000000;-g-r-a-y:#e2e5e6;-g-r-a-y_-b-o-l-d:#757575;-s-h-a-d-o-w:rgba(82,82,82,0.75);border:1px solid #b5a5a5;border-radius:1rem;-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);cursor:pointer;-webkit-transition:all 0.1s ease-out;transition:all 0.1s ease-out;}.css-1gprwe9:not(:first-of-type){margin-left:1rem;}.css-1gprwe9:hover{color:#000000 background-color:#b5a5a5;}@media (max-width: 768px){.css-1gprwe9{font-size:0.75rem;}}</style><a aria-label="Project 카테고리" class="css-1gprwe9 e12y0cgh0" href="/?category=Project">Project</a></span><span role="checkbox" aria-checked="false" class="css-onhpl3 e12y0cgh1"><a aria-label="JWT 카테고리" class="css-1gprwe9 e12y0cgh0" href="/?category=JWT">JWT</a></span></div><div class="css-0 ehbuenk0">2023.02.25.</div></div></div><style data-emotion="css 1ybhd0e">.css-1ybhd0e{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;margin:0 auto;padding:5rem 0;line-height:1.75;word-break:break-all;}.css-1ybhd0e h1,.css-1ybhd0e h2,.css-1ybhd0e h3{margin-bottom:1.5rem;font-weight:700;}.css-1ybhd0e h1{padding-left:0.2rem;font-size:2rem;border-bottom:1px solid #e2e5e6;}.css-1ybhd0e h2{font-size:1.75rem;border-bottom:1px solid #e2e5e6;}.css-1ybhd0e h3{font-size:1.25rem;}.css-1ybhd0e *+h1,.css-1ybhd0e *+h2,.css-1ybhd0e *+h3{margin-top:2rem;margin-bottom:0.5rem;}.css-1ybhd0e hr+h1,.css-1ybhd0e hr+h2,.css-1ybhd0e hr+h3{margin-top:0;}.css-1ybhd0e blockquote{margin:30px 0;padding:0 1rem;color:#757575;font-weight:800;border-left:2px solid #e2e5e6;}.css-1ybhd0e ol,.css-1ybhd0e ul{margin-top:0rem;margin-bottom:0rem;margin-left:1rem;padding:0.5rem 0;}.css-1ybhd0e li{font-weight:300;}.css-1ybhd0e hr{margin:100px 0;border:1px solid #000;}.css-1ybhd0e a{color:#0E68C8;}.css-1ybhd0e p{margin:0;padding:0.5rem 0;font-weight:300;}.css-1ybhd0e img{margin:3rem 0;}.css-1ybhd0e pre[class*='language-'],.css-1ybhd0e code[class*='language-']{color:#d4d4d4;font-size:13px;font-family:Menlo,Monaco,Consolas,'Andale Mono','Ubuntu Mono','Courier New',monospace;direction:ltr;white-space:pre;text-align:left;text-shadow:none;word-break:normal;word-spacing:normal;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;border-radius:0.5rem;}.css-1ybhd0e pre[class*='language-']::selection,.css-1ybhd0e code[class*='language-']::selection,.css-1ybhd0e pre[class*='language-'] *::selection,.css-1ybhd0e code[class*='language-'] *::selection{text-shadow:none;background:#264f78;}@media print{.css-1ybhd0e pre[class*='language-'],.css-1ybhd0e code[class*='language-']{text-shadow:none;}}.css-1ybhd0e pre[class*='language-']{padding:1rem;overflow:auto;background:#1e1e1e;}.css-1ybhd0e:not(pre)>code[class*='language-']{padding:0.1em 0.3em;background:#1e1e1e;border-radius:0;border-radius:0.3em;}.css-1ybhd0e .namespace{opacity:0.7;}.css-1ybhd0e .token.doctype .token.doctype-tag{color:#569cd6;}.css-1ybhd0e .token.doctype .token.name{color:#9cdcfe;}.css-1ybhd0e .token.comment,.css-1ybhd0e .token.prolog{color:#6a9955;}.css-1ybhd0e .token.punctuation,.css-1ybhd0e .language-html .language-css .token.punctuation,.css-1ybhd0e .language-html .language-javascript .token.punctuation{color:#d4d4d4;}.css-1ybhd0e .token.property,.css-1ybhd0e .token.tag,.css-1ybhd0e .token.boolean,.css-1ybhd0e .token.number,.css-1ybhd0e .token.constant,.css-1ybhd0e .token.symbol,.css-1ybhd0e .token.inserted,.css-1ybhd0e .token.unit{color:#b5cea8;}.css-1ybhd0e .token.selector,.css-1ybhd0e .token.attr-name,.css-1ybhd0e .token.string,.css-1ybhd0e .token.char,.css-1ybhd0e .token.builtin,.css-1ybhd0e .token.deleted{color:#ce9178;}.css-1ybhd0e .language-css .token.string.url{-webkit-text-decoration:underline;text-decoration:underline;}.css-1ybhd0e .token.operator,.css-1ybhd0e .token.entity{color:#d4d4d4;}.css-1ybhd0e .token.operator.arrow{color:#569cd6;}.css-1ybhd0e .token.atrule{color:#ce9178;}.css-1ybhd0e .token.atrule .token.rule{color:#c586c0;}.css-1ybhd0e .token.atrule .token.url{color:#9cdcfe;}.css-1ybhd0e .token.atrule .token.url .token.function{color:#dcdcaa;}.css-1ybhd0e .token.atrule .token.url .token.punctuation{color:#d4d4d4;}.css-1ybhd0e .token.keyword{color:#569cd6;}.css-1ybhd0e .token.keyword.module,.css-1ybhd0e .token.keyword.control-flow{color:#c586c0;}.css-1ybhd0e .token.function,.css-1ybhd0e .token.function .token.maybe-class-name{color:#dcdcaa;}.css-1ybhd0e .token.regex{color:#d16969;}.css-1ybhd0e .token.important{color:#569cd6;}.css-1ybhd0e .token.italic{font-style:italic;}.css-1ybhd0e .token.constant{color:#9cdcfe;}.css-1ybhd0e .token.class-name,.css-1ybhd0e .token.maybe-class-name{color:#4ec9b0;}.css-1ybhd0e .token.console{color:#9cdcfe;}.css-1ybhd0e .token.parameter{color:#9cdcfe;}.css-1ybhd0e .token.interpolation{color:#9cdcfe;}.css-1ybhd0e .token.punctuation.interpolation-punctuation{color:#569cd6;}.css-1ybhd0e .token.boolean{color:#569cd6;}.css-1ybhd0e .token.property,.css-1ybhd0e .token.variable,.css-1ybhd0e .token.imports .token.maybe-class-name,.css-1ybhd0e .token.exports .token.maybe-class-name{color:#9cdcfe;}.css-1ybhd0e .token.selector{color:#d7ba7d;}.css-1ybhd0e .token.escape{color:#d7ba7d;}.css-1ybhd0e .token.tag{color:#569cd6;}.css-1ybhd0e .token.tag .token.punctuation{color:#808080;}.css-1ybhd0e .token.cdata{color:#808080;}.css-1ybhd0e .token.attr-name{color:#9cdcfe;}.css-1ybhd0e .token.attr-value,.css-1ybhd0e .token.attr-value .token.punctuation{color:#ce9178;}.css-1ybhd0e .token.attr-value .token.punctuation.attr-equals{color:#d4d4d4;}.css-1ybhd0e .token.entity{color:#569cd6;}.css-1ybhd0e .token.namespace{color:#4ec9b0;}.css-1ybhd0e pre[class*='language-javascript'],.css-1ybhd0e code[class*='language-javascript'],.css-1ybhd0e pre[class*='language-jsx'],.css-1ybhd0e code[class*='language-jsx'],.css-1ybhd0e pre[class*='language-typescript'],.css-1ybhd0e code[class*='language-typescript'],.css-1ybhd0e pre[class*='language-tsx'],.css-1ybhd0e code[class*='language-tsx']{color:#9cdcfe;}.css-1ybhd0e pre[class*='language-css'],.css-1ybhd0e code[class*='language-css']{color:#ce9178;}.css-1ybhd0e pre[class*='language-html'],.css-1ybhd0e code[class*='language-html']{color:#d4d4d4;}.css-1ybhd0e .language-regex .token.anchor{color:#dcdcaa;}.css-1ybhd0e .language-html .token.punctuation{color:#808080;}.css-1ybhd0e pre[class*='language-']>code[class*='language-']{position:relative;z-index:1;}.css-1ybhd0e .line-highlight.line-highlight{z-index:0;background:#f7ebc6;box-shadow:inset 5px 0 0 #f7d87c;}.css-1ybhd0e pre[class*='language-text'],.css-1ybhd0e code[class*='language-text']{padding:0.25rem;color:#000000;background-color:#e2e5e6;}@media (max-width: 768px){.css-1ybhd0e img{width:100%;}.css-1ybhd0e pre[class*='language-']{width:100%;overflow-x:auto;}}</style><div class="css-1ybhd0e e13plzdv0"><p>개인 프로젝트를 하면서  Spring Security와 JWT를 활용하여 사용자 인증을 구현했습니다.</p>
<h2 id="의존성-설정" style="position:relative;"><a href="#%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%84%A4%EC%A0%95" aria-label="의존성 설정 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>의존성 설정</h2>
<div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.auth0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>java-jwt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.18.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.jsonwebtoken<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jjwt-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.11.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>

      
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.jsonwebtoken<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jjwt-jackson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.11.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.jsonwebtoken<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jjwt-impl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.11.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre></div>
<h2 id="시큐리티-커스텀하기" style="position:relative;"><a href="#%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0-%EC%BB%A4%EC%8A%A4%ED%85%80%ED%95%98%EA%B8%B0" aria-label="시큐리티 커스텀하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>시큐리티 커스텀하기</h2>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        http
                <span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">sessionManagement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sessionCreationPolicy</span><span class="token punctuation">(</span><span class="token class-name">SessionCreationPolicy</span><span class="token punctuation">.</span><span class="token constant">STATELESS</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addFilterBefore</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JWTAuthenticationFilter</span><span class="token punctuation">(</span>tokenHelper<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token class-name">UsernamePasswordAuthenticationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/auth/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<ul>
<li>WebSecurityConfigureAdapter 를 상속받으면 시큐리티 설정파일로 인식이 된다.</li>
<li>@Configuration 으로 해당 클래스를 IoC 컨테이너에 등록</li>
<li>@EnableWebSecurity 로 시큐리티 설정파일로 인식된 파일을 활성화 시킴</li>
<li>csrf().disable() : csrf 설정 disable</li>
<li>sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS) : 시큐리티는 기본적으로 세션을 사용하기 때문에 Stateless 로 설정</li>
<li>configure(HttpSecurity http) : Http 보안을 설정하는 메서드이다.
<ul>
<li>authorizeRequest() :  요청에 대한 권한을 설정하는 메서드이다.</li>
<li>antMatchers(“/auth/**“).permitAll() :  “/auth/**” 로 시작하는 요청은 전부 허용 (로그인 , 회원가입은 인증이 필요 없음)</li>
<li>anyRequest().authenticated() : 나머지 API 는 전부 API 요청이 필요함</li>
</ul>
</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token annotation punctuation">@Configuration</span> 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>
    

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"시큐리티 config @@"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        http
                <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">httpBasic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">sessionManagement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sessionCreationPolicy</span><span class="token punctuation">(</span><span class="token class-name">SessionCreationPolicy</span><span class="token punctuation">.</span><span class="token constant">STATELESS</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/api/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h2 id="로그인-구현에-필요한-인터페이스와-클래스" style="position:relative;"><a href="#%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EA%B5%AC%ED%98%84%EC%97%90-%ED%95%84%EC%9A%94%ED%95%9C-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EC%99%80-%ED%81%B4%EB%9E%98%EC%8A%A4" aria-label="로그인 구현에 필요한 인터페이스와 클래스 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>로그인 구현에 필요한 인터페이스와 클래스</h2>
<p><strong>로그인을 할 때 사용할  Dto 클래스</strong></p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SignInRequest</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@NotBlank</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NotBlank</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span> <span class="token function">toAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre></div>
<p>여기서 toAuthentication 메서드는 UsernamePasswordAuthenticationToken 를 생성한다.
UsernamePasswordAuthenticationToken 은 사용자의 인증 정보를 담고, 이후 Spring Security 에서
사용자의 인증 및 권한 부여를 수행하는 데 사용된다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/d27082e0f08afa204a3c15a412796d5e/536b4/img_3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 27.083333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/klEQVR42m2Q30sCQRDH778PAgkCwVBCIkIMr8v36NUKNSq8Hiwo6M4OxD13Z3bV4NvsXvYDeviwM/Pd+cJ8IyICE/8PM7xO/v0FW1tpbGGowtf+bxQWwtJfjDHIsgxlWcJZhpOZh8kgz2ei5SCt4EhgBWuU+BhEb/MXJOMj9G7aiIXedRvdqxYu0z6MXUFN7/GeNJD3W0ITxfkBltM7LDRj83QCc1uDGu3hI92Hmz96w1fEw0N0B81gdCp0Bg1cTBKQWwfDIq5jJqae4qwO8/wAbddieAw93sFitIvNpCaGaXWyz8M6+8M2o60mvfvC198xyYmWtcy1RLEMJ38CkL1udqBJpokAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/d27082e0f08afa204a3c15a412796d5e/a59e9/img_3.webp 192w,
/static/d27082e0f08afa204a3c15a412796d5e/0ca9f/img_3.webp 384w,
/static/d27082e0f08afa204a3c15a412796d5e/dc9b9/img_3.webp 768w,
/static/d27082e0f08afa204a3c15a412796d5e/b3fdc/img_3.webp 983w"
              sizes="(max-width: 768px) 100vw, 768px"
              type="image/webp"
            />
          <source
            srcset="/static/d27082e0f08afa204a3c15a412796d5e/3b721/img_3.png 192w,
/static/d27082e0f08afa204a3c15a412796d5e/66595/img_3.png 384w,
/static/d27082e0f08afa204a3c15a412796d5e/fe486/img_3.png 768w,
/static/d27082e0f08afa204a3c15a412796d5e/536b4/img_3.png 983w"
            sizes="(max-width: 768px) 100vw, 768px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/d27082e0f08afa204a3c15a412796d5e/fe486/img_3.png"
            alt="img_3.png"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>UsernamePasswordAuthenticationToken 클래스는  추상 클래스 AbstractAuthenticationToken 의 자식 클래스이고
AbstractAuthenticationToken 는 Authentication 인터페이스를 구현하였다.</p>
<h4 id="authentication-인터페이스" style="position:relative;"><a href="#authentication-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4" aria-label="authentication 인터페이스 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Authentication 인터페이스</h4>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Authentication</span> <span class="token keyword">extends</span> <span class="token class-name">Principal</span><span class="token punctuation">,</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

	
	<span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">GrantedAuthority</span><span class="token punctuation">></span></span> <span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token class-name">Object</span> <span class="token function">getCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	
	<span class="token class-name">Object</span> <span class="token function">getDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	
	<span class="token class-name">Object</span> <span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	
	<span class="token keyword">boolean</span> <span class="token function">isAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	
	<span class="token keyword">void</span> <span class="token function">setAuthenticated</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> isAuthenticated<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>사용자의 인증 정보를 저장하는 토큰 개념</li>
<li>인증 시 id 와 password 를 담고 인증 검증을 위해 전달 되어 사용된다.</li>
<li>인증 후 최종 인증 결과를 담고 SecurityContext 에 저장되어 전역적으로 참조가 가능하다.</li>
</ul>
<p><strong>토큰 생성  Dto</strong></p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Builder</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TokenDto</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> grantType<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> accessToken<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> accessTokenExpiresIn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>인가 유형, ,엑세스 토큰 , 엑세스 토큰의 만료 시간</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">{</span>
    
	<span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre></div>
<p>Spring Security 에 있는 UserDetailsService 인터페이스</p>
<p><strong>UserDetailService</strong> 란?</p>
<p>Spring Security 에서 유저의 정보를 가져오는 인터페이스이다.</p>
<p>loadUserByUsername(String username) 메서드 :</p>
<p>username 을 기반으로 사용자 정보를 가져오는 메서드이다.  이 메서드를 구현하여 사용자의 인증 정보를
데이터베이스나 다른 소스로부터 읽어오게 된다.</p>
<p>사용자 정보를 가져온 뒤, 해당 정보를 스프링 시큐리티가 이해할 수 있는 UserDetails 객체로 변환하여 반환한다.</p>
<p>Spring Security의 <strong>UserDetails</strong> 인터페이스</p>
<p>사용자의 정보를 담는 인터페이스이다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDetails</span> <span class="token keyword">extends</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

	
	<span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">GrantedAuthority</span><span class="token punctuation">></span></span> <span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
	<span class="token class-name">String</span> <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
	<span class="token class-name">String</span> <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
	<span class="token keyword">boolean</span> <span class="token function">isAccountNonExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
	<span class="token keyword">boolean</span> <span class="token function">isAccountNonLocked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
	<span class="token keyword">boolean</span> <span class="token function">isCredentialsNonExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
	<span class="token keyword">boolean</span> <span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div>
<ul>
<li>getAuthorities() : 계정이 갖고 있는 권한 목록을 리턴한다.</li>
<li>getPassword() : 계정의 비밀번호를 리턴한다.</li>
<li>getUsername() : 계정의 이름을 리턴한다.</li>
<li>isAccountNonExpired() : 계정이 만료되지 않았는지 리턴한다.</li>
<li>isAccountNonLocked() : 계정이 잠겨 있지 않았는지 리턴한다.</li>
<li>isCredentialsNonExpired() : 비밀번호가 만료되지 않았는지 리턴한다.</li>
<li>isEnabled() : 계정이 사용 가능한지 리턴한다.</li>
</ul>
<p><strong>UserDetailsService 구현하기</strong></p>
<p>UserRepository 에서 유저 정보를 가져 온다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrincipleDetailService</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">UserRepository</span> userRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> userEntity <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CustomApiException</span><span class="token punctuation">(</span><span class="token string">"존재하지 않는 아이디 입니다."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PrincipalDetails</span><span class="token punctuation">(</span>userEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>UserDetails 구현하기</strong></p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrincipalDetails</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetails</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">User</span> user<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PrincipalDetails</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> user<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">GrantedAuthority</span><span class="token punctuation">></span></span> <span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GrantedAuthority</span><span class="token punctuation">></span></span> collector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        collector<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token string">"USER_ROLE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> collector<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAccountNonExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAccountNonLocked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isCredentialsNonExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>토큰 생성 클래스</strong></p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JWTTokenHelper</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserRepository</span> userRepository<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">AUTHORITIES_KEY</span> <span class="token operator">=</span> <span class="token string">"auth"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">BEARER_TYPE</span> <span class="token operator">=</span> <span class="token string">"Bearer"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">ACCESS_TOKEN_EXPIRE_TIME</span> <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span><span class="token number">30</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Key</span> key<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">JWTTokenHelper</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${jwt.secret}"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> secretKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> keyBytes <span class="token operator">=</span> <span class="token class-name">Decoders</span><span class="token punctuation">.</span><span class="token constant">BASE64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>secretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> <span class="token class-name">Keys</span><span class="token punctuation">.</span><span class="token function">hmacShaKeyFor</span><span class="token punctuation">(</span>keyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">TokenDto</span> <span class="token function">generateTokenDto</span><span class="token punctuation">(</span><span class="token class-name">Authentication</span> authentication<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> now <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrincipalDetails</span> principalDetails <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">PrincipalDetails</span><span class="token punctuation">)</span> authentication<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Date</span> accessTokenExpiresIn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>now <span class="token operator">+</span> <span class="token constant">ACCESS_TOKEN_EXPIRE_TIME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> userEntity <span class="token operator">=</span> principalDetails<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">ClaimDto</span> claimDto <span class="token operator">=</span> <span class="token class-name">ClaimDto</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>userEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">nickname</span><span class="token punctuation">(</span>userEntity<span class="token punctuation">.</span><span class="token function">getNickname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">email</span><span class="token punctuation">(</span>userEntity<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> accessToken <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>authentication<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span><span class="token constant">AUTHORITIES_KEY</span><span class="token punctuation">,</span> claimDto<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setExpiration</span><span class="token punctuation">(</span>accessTokenExpiresIn<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">signWith</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">SignatureAlgorithm</span><span class="token punctuation">.</span><span class="token constant">HS512</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">compact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        

        <span class="token keyword">return</span> <span class="token class-name">TokenDto</span>
                <span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">grantType</span><span class="token punctuation">(</span><span class="token constant">BEARER_TYPE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">accessToken</span><span class="token punctuation">(</span>accessToken<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">accessTokenExpiresIn</span><span class="token punctuation">(</span>accessTokenExpiresIn<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Authentication</span> <span class="token function">getAuthentication</span><span class="token punctuation">(</span><span class="token class-name">String</span> accessToken<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token function">parseClaims</span><span class="token punctuation">(</span>accessToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>claims<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">AUTHORITIES_KEY</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"권한 정보가 없는 토큰입니다."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ClaimDto</span> claimDto <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">convertValue</span><span class="token punctuation">(</span>claims<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">AUTHORITIES_KEY</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">ClaimDto</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>claimDto<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CustomApiException</span><span class="token punctuation">(</span><span class="token string">"존재하지 않는 아이디 입니다."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrincipalDetails</span> principalDetails <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrincipalDetails</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>principalDetails<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span>principalDetails<span class="token punctuation">.</span><span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">validateToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parserBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span>SecurityException</span> <span class="token operator">|</span> <span class="token class-name">MalformedJwtException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"잘못된 JWT 서명입니다."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ExpiredJwtException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"만료된 JWT 토큰입니다."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnsupportedJwtException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"지원되지 않는 JWT 토큰입니다."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalArgumentException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"JWT 토큰이 잘못되었습니다."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Claims</span> <span class="token function">parseClaims</span><span class="token punctuation">(</span><span class="token class-name">String</span> accessToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parserBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>accessToken<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ExpiredJwtException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> e<span class="token punctuation">.</span><span class="token function">getClaims</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li><strong>generateTokenDto</strong>
<ul>
<li>유저 정보를 파라미터로 받아서 access token 과 refresh token 을 생성한다.</li>
<li>엑세스 토큰의 만료 시간을 30분으로 지정</li>
<li>사용자의 id와 닉네임, 이메일로 클레임을 생성 (JWT 이 헤더 , 페이로드 , 서명 중 페이로드에 해당 함)</li>
<li>시크릿 키와 HS516 암호화 알고리즘을 통해 토큰을 서명한다.</li>
</ul>
</li>
<li><strong>getAuthentication</strong>
<ul>
<li>JWT 토큰을 복호화하여 토큰에 들어 있는 정보를 꺼낸다.</li>
<li>UserDetails 를 구현한 PrincipalDetails 객체를 만들어서 Authentication 을 리턴한다.</li>
</ul>
</li>
<li><strong>validateToken</strong>
<ul>
<li>토큰 정보를 검증한다.</li>
<li>Jwts 모듈이 알아서 Exception 을 던져준다.</li>
</ul>
</li>
</ul>
<p><strong>필터 등록하기</strong></p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JWTAuthenticationFilter</span> <span class="token keyword">extends</span> <span class="token class-name">OncePerRequestFilter</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">AUTHORIZATION_HEADER</span> <span class="token operator">=</span> <span class="token string">"Authorization"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">BEARER_PREFIX</span> <span class="token operator">=</span><span class="token string">"Bearer "</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JWTTokenHelper</span> tokenHelper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doFilterInternal</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> jwt <span class="token operator">=</span> <span class="token function">resolveToken</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>jwt<span class="token punctuation">)</span> <span class="token operator">&amp;</span> tokenHelper<span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>jwt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">Authentication</span> authentication <span class="token operator">=</span> tokenHelper<span class="token punctuation">.</span><span class="token function">getAuthentication</span><span class="token punctuation">(</span>jwt<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authentication<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">resolveToken</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> bearerToken <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token constant">AUTHORIZATION_HEADER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>bearerToken<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> bearerToken<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token constant">BEARER_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> bearerToken<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>OncePerRequestFilter 인터페이스를 구현하기 때문에 요청 받을 때 단 한번만 실행된다.</li>
<li>doFilterInternal
<ul>
<li>실제 필터링 로직을 수행하는 곳이다.</li>
<li>Request Header 에서 Access Token 을 꺼내서 여러가지 검사 후 유저 정보를 꺼내서 SecurityContext 에 저장한다.</li>
<li>가입/로그인/재발급을 제외한 모든 Request 요청은 이 필터를 거치기 때문에 토큰 정보가 없거나, 유효하지 않으면 정상적으로 수행되지 않는다.</li>
</ul>
</li>
</ul>
<p>그리고 위의 작성한 필터를 스프링 시큐리티 설정 클래스에 추가하자</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token annotation punctuation">@Configuration</span> 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JWTTokenHelper</span> tokenHelper<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JwtAuthenticationEntryPoint</span> jwtAuthenticationEntryPoint<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">CorsConfig</span> corsConfig<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">AuthenticationManager</span> <span class="token function">authenticationManagerBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">authenticationManagerBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">BCryptPasswordEncoder</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>auth<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        http
                <span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">sessionManagement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sessionCreationPolicy</span><span class="token punctuation">(</span><span class="token class-name">SessionCreationPolicy</span><span class="token punctuation">.</span><span class="token constant">STATELESS</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">exceptionHandling</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">authenticationEntryPoint</span><span class="token punctuation">(</span>jwtAuthenticationEntryPoint<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addFilter</span><span class="token punctuation">(</span>corsConfig<span class="token punctuation">.</span><span class="token function">corsFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addFilterBefore</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JWTAuthenticationFilter</span><span class="token punctuation">(</span>tokenHelper<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token class-name">UsernamePasswordAuthenticationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/auth/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>로그인에 필요한 클래스와 인터페이스를 생성했으니,
이제 로그인을 구현 해보자.</p>
<h2 id="로그인-구현" style="position:relative;"><a href="#%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EA%B5%AC%ED%98%84" aria-label="로그인 구현 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>로그인 구현</h2>
<h3 id="백엔드" style="position:relative;"><a href="#%EB%B0%B1%EC%97%94%EB%93%9C" aria-label="백엔드 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>백엔드</strong></h3>
<p>컨트롤러</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/auth/signin"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">signin</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SignInRequest</span> signInRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">OK</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RespDto</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"로그인 성공"</span><span class="token punctuation">,</span>authService<span class="token punctuation">.</span><span class="token function">signin</span><span class="token punctuation">(</span>signInRequest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre></div>
<p>비즈니스 로직</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">    <span class="token annotation punctuation">@Transactional</span>
    <span class="token keyword">public</span> <span class="token class-name">SignInResponse</span> <span class="token function">signin</span><span class="token punctuation">(</span><span class="token class-name">SignInRequest</span> signInRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UsernamePasswordAuthenticationToken</span> authenticationToken <span class="token operator">=</span> signInRequest<span class="token punctuation">.</span><span class="token function">toAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Authentication</span> authenticate <span class="token operator">=</span> authenticationManager<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span>authenticationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrincipalDetails</span> principal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">PrincipalDetails</span><span class="token punctuation">)</span> authenticate<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">TokenDto</span> tokenDto <span class="token operator">=</span> tokenHelper<span class="token punctuation">.</span><span class="token function">generateTokenDto</span><span class="token punctuation">(</span>authenticate<span class="token punctuation">)</span><span class="token punctuation">;</span>
        

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SignInResponse</span><span class="token punctuation">(</span>tokenDto<span class="token punctuation">,</span>principal<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre></div>
<p>클라이언트로 받은 요청 DTO를 통해  UsernamePasswordAuthenticationToken 토큰을 생성하고,</p>
<p>생성된 authenticationToken와 AuthenticationManager를 사용하여 사용자를 인증한다.</p>
<p>authenticate() 메서드가 실행 될 때  UserDetailsService 를 구현한 PrincipleDetailService 클래스의
loadUserByUsername 메서드가 실행이 된다.</p>
<p>이때, 사용자의 유저 정보를 점검한다. 그런데, 아무리 봐도 비밀번호를 체크하는 코드는 없다.
스프링 시큐리티는 언제, 어디서 비밀번호를 체크하는 것일까??</p>
<p>관련 자료를 찾던 중에 <a href="https://github.com/HomoEfficio/dev-tips/blob/master/Spring%20Security%EC%9D%98%20%EC%82%AC%EC%9A%A9%EC%9E%90%20%EB%B9%84%EB%B0%80%EB%B2%88%ED%98%B8%20%EA%B2%80%EC%82%AC.md" target="_blank" rel="nofollow">Spring Security의 사용자 비밀번호 검사</a> 라는 글을 발견 하였다.</p>
<p>그리고 위 글에서 DaoAuthenticationProvider 클래스에서 비밀번호를 검사한다고 하여</p>
<p>인텔리제이 메서드 검색 기능을 활용하여 DaoAuthenticationProvider 클래스를 찾아보았다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/96998d394a3a635c13abb84e409e051e/d880f/img_1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKElEQVR42mWTWZLbMAxEfRyZ4r5psSwl3mf+k8r9L9JpUJ6qLB+vQLlMAN0ADz8vG358P+HXbcXH44bL/Y7b9YLb5UouuJJ1PaPUikxKHf7jdF4xzTOW6wMHbRxC3yE6A58qQswN5yOc8fAmwGoHy7PRBsdj9+b4pkOvFJQ6wlmLgwsRXiuUYDAV35hrwFACcsrImV2VocUk8LdIAu8J8es7JcScmdDLRYOhelYwUL1600NpjWOv0fPc4Leg/8EYC22okAUOPgSMOWBb6EVNeGaHF7uUKFyyRy3sjF1GdpGJc5TPBJJIohQ7UnalxwfJquhDCh6n5czEK7bzGeuyYJlmbCwyj0yWC1L0yNE1aU1mTPBU2BLSzzoMu2SR502PUXwcZ05twzCNKINMNaBQQYoBxmlYb2CthuN/jd3tkC4tB5K+PNS6h6WMnh4GVk5cBR8ojUkcu5LoiaWKHcf/0ju3J5VkgdZJx81DqXIqEZ+14FVPZMKdvr0o+TVN+JhPeA4jHpT0HKfGjV4uzrVhaN7vuq7J/0Oywuw1ztOCbfuGeZ4wTpUWRIz0cSj0LUontsUkXibH7i0TOeL3Dh071FwN1XNpmVizfZGv2ypwLejtHunXO/4F7dLavGWnfcopKGRiuOCWCazZo2l7ZhrtLAVZ2JBe6f0skqUY74p9Bxl/ZevyQmoKmAdZk9TiyCnLKsh7HeQd07fK1yLIK0r8thykdYLm4CJ+A+OGm64OYfRAAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/96998d394a3a635c13abb84e409e051e/a59e9/img_1.webp 192w,
/static/96998d394a3a635c13abb84e409e051e/0ca9f/img_1.webp 384w,
/static/96998d394a3a635c13abb84e409e051e/dc9b9/img_1.webp 768w,
/static/96998d394a3a635c13abb84e409e051e/78344/img_1.webp 975w"
              sizes="(max-width: 768px) 100vw, 768px"
              type="image/webp"
            />
          <source
            srcset="/static/96998d394a3a635c13abb84e409e051e/3b721/img_1.png 192w,
/static/96998d394a3a635c13abb84e409e051e/66595/img_1.png 384w,
/static/96998d394a3a635c13abb84e409e051e/fe486/img_1.png 768w,
/static/96998d394a3a635c13abb84e409e051e/d880f/img_1.png 975w"
            sizes="(max-width: 768px) 100vw, 768px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/96998d394a3a635c13abb84e409e051e/fe486/img_1.png"
            alt="img_1.png"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>DaoAuthenticationProvider 클래스의 additionalAuthenticationChecks 메서드에서 비밀번호를 검증한다.</p>
<ul>
<li>Request 로 받아서 만든 authentication 과 DB에서 꺼낸 값인 userDetails의 비밀번호를 비교</li>
<li>DB에 있는 값은 암호화 된 값이고 사용자가 입력한 값은 raw 값이지만 passwordEncoder 를 사용하여 비교 가능</li>
</ul>
<p>그리고 비밀번호를 검증하는 메서드 외에 발견한 것이 있었다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/80a2b7c70e36d9c4e6d8a57ba9b069a5/a6711/img.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABu0lEQVR42pVTS3LVQAz0dfCM5v/xs0OKJECxYQvc/yJNa8Z+EIoqwqJLsmS3pJa8fP/yGd8+PuHHpyd8JfptR6kbajvR+0RT+9vz8LcR79sNx8N7bLcDS4oF2a3Y04rkDFIQ1CTIccKHMOEDglh4cUSAEw+xAuccxFmkHBGixxJyRQgWvRhEbxCcIAZHn4SMx0iioOAH3hGBOfXjLMLcJCU580sshUkSZsFObL1hOx45xoaHg+PUxA61+i8bU6KNtPm0jDGe+LzEVGAMW2aiUZvSpl6F+uWcWV0gIrAKawn13R3C7jRuzEoYEuYyAmJXtFqx7zs6xe6tUUOPwnyp9JlLpaKzkxfimQ18YMfalfMeZv2DUB8cRS/Ur5TIDVZCicpEycN6FnHCdymT4zJ0IeJlTPKKUBG5Zc9qkaNaa7Cu785RZnXDmB3g+2Lv313+IEzc8kVW2cW2H+MW23ljmQX1bFTHQfoPkPDS0GKreSxGt5e4fdVnbJDQzv+DUMbR1ugGiZ6Cnse08zz0ZOwbujw1nIQt+TGiHus8h/Nc7idj30rIX4oatuTQuJBLuznyhE4yxtf4VfQvHf8EgI6WXyDNuqkAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/80a2b7c70e36d9c4e6d8a57ba9b069a5/a59e9/img.webp 192w,
/static/80a2b7c70e36d9c4e6d8a57ba9b069a5/0ca9f/img.webp 384w,
/static/80a2b7c70e36d9c4e6d8a57ba9b069a5/dc9b9/img.webp 768w,
/static/80a2b7c70e36d9c4e6d8a57ba9b069a5/5112c/img.webp 943w"
              sizes="(max-width: 768px) 100vw, 768px"
              type="image/webp"
            />
          <source
            srcset="/static/80a2b7c70e36d9c4e6d8a57ba9b069a5/3b721/img.png 192w,
/static/80a2b7c70e36d9c4e6d8a57ba9b069a5/66595/img.png 384w,
/static/80a2b7c70e36d9c4e6d8a57ba9b069a5/fe486/img.png 768w,
/static/80a2b7c70e36d9c4e6d8a57ba9b069a5/a6711/img.png 943w"
            sizes="(max-width: 768px) 100vw, 768px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/80a2b7c70e36d9c4e6d8a57ba9b069a5/fe486/img.png"
            alt="img.png"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>DaoAuthenticationProvider 클래스의
retrieveUser 메소드 내부에서 loadUserByUsername() 메서드를 호출한다.</p>
<p>그리고 retrieveUser 메서드는 어디서 호출하는 지 찾아보니</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/0dbc63fefc503efe6407f5e7164655fb/1d15d/img_2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 65.10416666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+UlEQVR42mVTy5LUMBCb74mf7Vec1+wss0UVBbtcOXCB//8HITvJsAsHVXccR5bkzqVerxjHjHUilhlP9zt+fH/F79cX/Hr7jJ/fvhBf8cb69HzHdr1h477rdsV2u2PZbpiWDTMxzQsuKY/QxsBoBS8BMSZMOWGrM9Z5xcKNCzeWqRIjag0oRTCyL1NBSAInDhJ9r5dUKoy1JDQI4kmYkXLBTLJSRySqPyHRwTgN602vDU4MrDVQSkFR1EHo4J3FNtcufVk3jDy5hIgQEmJqh4wIVB+4ZrTeCRoG9bdXB6F1DloNKGMjXJFigLcKAzdo9e5j9ppkwzB0qAO9/5ewLTqjaSuhOo8XESxeeq7e+64yxAjpqmNX+7535FAU9SBs7N4o5OAxcm3mpdRakUvhIYG5OWZl4UhuuL/l3tRqZr9DnwqnB2G76cyQ15JRy0LrGZEKGppKTQdNseFUaPUxu/8s77eku8rkCFoUaRYDq0CcYa6yK9HDoU49sAsyHzNsNoR9IMk4Lf2SImcy5sB543oiOSNx3sIH2pcdvlVOSTv8IPTdrmO13vecWl6WFtt6V0TlJ7oaqx/Pre/PxD6HfWxokye1PyWGwnqA85fL2FVbzmtz02F3mF53AT3DeFpmJpn1ztA/+QbpeD5zPNHGSGQH37vHaEkX9Qc5NZrJ3KmTPAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/0dbc63fefc503efe6407f5e7164655fb/a59e9/img_2.webp 192w,
/static/0dbc63fefc503efe6407f5e7164655fb/0ca9f/img_2.webp 384w,
/static/0dbc63fefc503efe6407f5e7164655fb/dc9b9/img_2.webp 768w,
/static/0dbc63fefc503efe6407f5e7164655fb/ee9cc/img_2.webp 931w"
              sizes="(max-width: 768px) 100vw, 768px"
              type="image/webp"
            />
          <source
            srcset="/static/0dbc63fefc503efe6407f5e7164655fb/3b721/img_2.png 192w,
/static/0dbc63fefc503efe6407f5e7164655fb/66595/img_2.png 384w,
/static/0dbc63fefc503efe6407f5e7164655fb/fe486/img_2.png 768w,
/static/0dbc63fefc503efe6407f5e7164655fb/1d15d/img_2.png 931w"
            sizes="(max-width: 768px) 100vw, 768px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/0dbc63fefc503efe6407f5e7164655fb/fe486/img_2.png"
            alt="img_2.png"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>DaoAuthenticationProvider 클래스의 부모 클래스인 AbstractUserDetailsAuthenticationProvider 클래스의
authenticate 메소드에서 호출하고 있었다.</p>
<p>그리고 여기서 비밀번호를 검증하는 additionalAuthenticationChecks 메서드로 호출하고 있었다.</p>
<p>클래스 구조를 그림으로 나타내면 다음과 같다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c4293d26dcffed4df286e8950fc29a04/acfc2/img_4.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 26.041666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVR42m3QTUsDMRAG4P3j4m/wYIUiHhQ/Kt2C4qWK7cleFA9F0S34UVq34G67m93MZNPL6yTpQdDDQzKTZJhMRET4DzN7Wva/kcsb4+9ocufGIwq5KBTQ8pg82siyDEVRoDEMI7Hj9pUqkaYplFJouISlXCxh9CoUfP9OED8e4OyuHYzauBqf4Gu1QPkxQdprYRa3MHd6e5h3dpDfD1BJd+ppH/loS2yjHu+CqUI0zd5w/dJF/zne6GKYXCCvl6DFDOr2FGrQCYbnUDfHoNcHaGPB0z44OQRPjmA+L6XDGhGzka9Y2GYtrOdilg78vOz6DzJNmLOsbCQn98khwg/V2W/1diRSfgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/c4293d26dcffed4df286e8950fc29a04/a59e9/img_4.webp 192w,
/static/c4293d26dcffed4df286e8950fc29a04/0ca9f/img_4.webp 384w,
/static/c4293d26dcffed4df286e8950fc29a04/dc9b9/img_4.webp 768w,
/static/c4293d26dcffed4df286e8950fc29a04/c1fee/img_4.webp 1091w"
              sizes="(max-width: 768px) 100vw, 768px"
              type="image/webp"
            />
          <source
            srcset="/static/c4293d26dcffed4df286e8950fc29a04/3b721/img_4.png 192w,
/static/c4293d26dcffed4df286e8950fc29a04/66595/img_4.png 384w,
/static/c4293d26dcffed4df286e8950fc29a04/fe486/img_4.png 768w,
/static/c4293d26dcffed4df286e8950fc29a04/acfc2/img_4.png 1091w"
            sizes="(max-width: 768px) 100vw, 768px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/c4293d26dcffed4df286e8950fc29a04/fe486/img_4.png"
            alt="img_4.png"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h3 id="프론트-엔드" style="position:relative;"><a href="#%ED%94%84%EB%A1%A0%ED%8A%B8-%EC%97%94%EB%93%9C" aria-label="프론트 엔드 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>프론트 엔드</strong></h3>
<p>로그인 요청 버튼 클릭  (signIn 메소드 호출)</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">  <span class="token keyword">const</span> <span class="token function-variable function">signin</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">e</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">(</span>
      <span class="token keyword">await</span> <span class="token function">SignInUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">createPayload</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">username</span><span class="token operator">:</span> username<span class="token punctuation">,</span>
          <span class="token literal-property property">password</span><span class="token operator">:</span> password<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span>entity<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"access_token"</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>tokenDto<span class="token punctuation">.</span>accessToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> id <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>user<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
      <span class="token keyword">const</span> username <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>user<span class="token punctuation">.</span>username<span class="token punctuation">;</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> id<span class="token punctuation">,</span> <span class="token literal-property property">username</span><span class="token operator">:</span> username <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">navigate</span><span class="token punctuation">(</span><span class="token string">"/story"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"로그인 실패 "</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>로그인 버튼을 클릭하고 인증에 성공 하게 되면, 응답으로 token 객체를 받게 된다.
응답 받은 토큰을 세션 스토리지에 저장한다.</p>
<p>※ 세션스토리지에 저장하면 XSS 공격에 의해 토큰이 탈취될 수도 있는 위험이 있고, 브라우저 탭을 닫으면 스토리지에 있는
데이터가 날아가는 단점이 있다.</p>
<p>세션 스토리지에서 엑세스 토큰을 가져온다.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">authHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> user <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"access_token"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">Authorization</span><span class="token operator">:</span> <span class="token string">"Bearer "</span> <span class="token operator">+</span> user <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>이 후 서버에 요청 할때 마다 http 헤더에 토큰을 실어서 요청한다.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">function</span> produceCreateAPI<span class="token operator">&lt;</span>entityCreateProp<span class="token punctuation">,</span> returnEntityType<span class="token operator">></span><span class="token punctuation">(</span>
  <span class="token literal-property property">apiPath</span><span class="token operator">:</span> string
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>
    createPayload<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token operator">:</span> CreateProps<span class="token operator">&lt;</span>entityCreateProp<span class="token operator">></span></span><span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span><span class="token punctuation">{</span> <span class="token literal-property property">entity</span><span class="token operator">:</span> returnEntityType <span class="token punctuation">}</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token literal-property property">res</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>apiPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> createPayload<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token function">authHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">entity</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token operator">:</span> any<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">throw</span> error<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div></div><style data-emotion="css hx9xpc">@media (max-width: 768px){.css-hx9xpc{padding:0 20px;}}</style><div class="css-hx9xpc e12j4d8y0"></div><style data-emotion="css fmunkh">.css-fmunkh{position:absolute;top:0;left:768px;height:100%;padding-left:4rem;}@media (max-width: 1400px){.css-fmunkh{display:none;}}</style><aside class="css-fmunkh ek4ynda1"><style data-emotion="css 1s5ilwz">.css-1s5ilwz{position:-webkit-sticky;position:sticky;top:6rem;width:240px;overflow:hidden;font-size:0.8rem;}.css-1s5ilwz p{margin:0;}.css-1s5ilwz a{display:block;padding:0.5rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;border-radius:4px;-webkit-transition:all 0.1s ease-out;transition:all 0.1s ease-out;}.css-1s5ilwz a:hover{background-color:#badcff;}.css-1s5ilwz ul:first-child{border-left:none;}.css-1s5ilwz ul{margin-left:0.5rem;padding:0 0.5rem;list-style:none;border-left:2px solid #e2e5e6;}</style><nav class="css-1s5ilwz ek4ynda0"><ul>
<li>
<p><a href="#%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%84%A4%EC%A0%95">의존성 설정</a></p>
</li>
<li>
<p><a href="#%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0-%EC%BB%A4%EC%8A%A4%ED%85%80%ED%95%98%EA%B8%B0">시큐리티 커스텀하기</a></p>
</li>
<li>
<p><a href="#%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EA%B5%AC%ED%98%84%EC%97%90-%ED%95%84%EC%9A%94%ED%95%9C-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EC%99%80-%ED%81%B4%EB%9E%98%EC%8A%A4">로그인 구현에 필요한 인터페이스와 클래스</a></p>
<ul>
<li>
<ul>
<li><a href="#authentication-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4">Authentication 인터페이스</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href="#%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EA%B5%AC%ED%98%84">로그인 구현</a></p>
<ul>
<li><a href="#%EB%B0%B1%EC%97%94%EB%93%9C"><strong>백엔드</strong></a></li>
<li><a href="#%ED%94%84%EB%A1%A0%ED%8A%B8-%EC%97%94%EB%93%9C"><strong>프론트 엔드</strong></a></li>
</ul>
</li>
</ul></nav></aside></div><style data-emotion="css 3xgn3f">.css-3xgn3f{display:grid;place-items:center;margin-top:auto;padding:50px 0;font-size:15px;color:#aaa;font-weight:bold;text-align:center;line-height:1.5;background-color:#f0f0f0;}@media (max-width: 768px){.css-3xgn3f{font-size:13px;}}</style><div class="css-3xgn3f ehmnl590"><br/>© 2023 박건희 Powered By Gatsby.</div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/Project/JWT를통한인증/jwt/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-11e3db64e010c7ace7b9.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-e0c32f7568409678d965.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-5d7d9b297e49292a0605.js\"],\"component---src-templates-post-template-tsx\":[\"/component---src-templates-post-template-tsx-cb73f70df489f33d96a5.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="e22d7df6bab760474b53";</script><script src="/webpack-runtime-e4e282c4b34170b3f4c3.js" async></script><script src="/framework-3fd3aa0b19c33d97812d.js" async></script><script src="/app-11e3db64e010c7ace7b9.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>